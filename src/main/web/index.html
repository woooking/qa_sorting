<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<link rel="stylesheet" href="css/google-icon.css">
	<link rel="stylesheet" href="css/materialize.min.css">
	<title>Title</title>
	<script id="answer-template" type="text/x-handlebars-template">
		<div class="collection">
		{{#each this}}
			<a class="collection-item" href="{{ link }}">{{{ title }}}</a>
		{{/each}}
		</div>
	</script>
</head>
<body>
<div class="container" style="margin-top: 100px">
	<div class="row">
		<form id="search-form" class="col m11" action="/query" method="get">
			<div class="input-field">
				<i class="material-icons prefix">search</i>
				<input id="search" name="query" placeholder="Please input your query here" type="text" autocomplete="off">
				<label for="search">Search</label>
			</div>
		</form>
		<div id="loader" class="col m1 hide">
			<div class="preloader-wrapper active">
				<div class="spinner-layer spinner-green-only">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div>
					<div class="gap-patch">
						<div class="circle"></div>
					</div>
					<div class="circle-clipper right">
						<div class="circle"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div id="origin-result" class="col m6"></div>
		<div id="new-result" class="col m6"></div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="js/materialize.min.js"></script>
<script src="js/handlebars-v4.0.5.js"></script>
<script>
	(function($) {
		var compiled = {};
		$.fn.handlebars = function(template, data) {
			if (template instanceof jQuery) {
				template = $(template).html();
			}
			compiled[template] = Handlebars.compile(template);
			this.html(compiled[template](data));
		};
	})(jQuery);

	$(document).ready(function () {
		var options = {
			beforeSubmit: function () {
				$("#loader").removeClass("hide");
			},
			dataType: "json",
			success: function (data) {
				$("#loader").addClass("hide");
				$('#new-result').handlebars($('#answer-template'), data["new"]);
				$('#origin-result').handlebars($('#answer-template'), data["origin"]);
			}
		};
		$("#search-form").ajaxForm(options);
	});
</script>
</body>
</html>